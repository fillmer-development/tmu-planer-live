(this["webpackJsonptmu-planer"]=this["webpackJsonptmu-planer"]||[]).push([[0],{14:function(e,t,n){e.exports=n(23)},22:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(11),l=n.n(r),i=n(2),o=n(8),u="ADD_SCHEDULE",s="LOAD_SCHEDULE",m="UPDATE_SCHEDULE",d="DELETE_SCHEDULE",p="ADD_STEP",v="UPDATE_STEP",f="DELETE_STEP",E="SHOW_SELECT_DIALOG",h="HIDE_SELECT_DIALOG",w="SET_SELECTED_TREE_NODE",b="SET_CONVERSION",g="ADD_SEGMENT",N="BULK_ADD_SEGMENT",y="DELETE_SEGMENT",O={localStorage:"tmu-planer-storage",unitConversion:[{name:"TMU",conversion:1},{name:"sec",conversion:.03},{name:"min",conversion:6e-4},{name:"h",conversion:1e-5}]},j=n(1),S=n(3),C=n(4),k=localStorage.getItem(O.localStorage),D=k?JSON.parse(k):{},T=Object(o.b)(Object(o.a)({schedule:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=Object(C.a)(t,["type"]);switch(n){case b:return Object(j.a)({},e,{conversion:a.value});case s:return Object(j.a)({conversion:1,steps:[]},a);case p:return Object(j.a)({},e,{steps:[].concat(Object(S.a)(e.steps),[a])});case v:return Object(j.a)({},e,{steps:e.steps.map((function(e){return e.id!==a.id?e:Object(j.a)({},e,{},a)}))});case f:return Object(j.a)({},e,{steps:e.steps.filter((function(e){return e.id!==a.id}))});case d:return a.isCurrent?{}:e;default:return e}},selector:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=Object(C.a)(t,["type"]);switch(n){case E:return Object(j.a)({},e,{visible:!0});case h:return Object(j.a)({},e,{visible:!1});case w:return Object(j.a)({},e,{currentNode:a.name});default:return e}},schedules:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=Object(C.a)(t,["type"]);switch(n){case u:return[].concat(Object(S.a)(e),[a]);case m:return e.map((function(e){return e.id!==a.id?e:Object(j.a)({},e,{},a)}));case d:return e.filter((function(e){return e.id!==a.id}));default:return e.filter((function(e){return e.name}))}},currentScheduleId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.id;switch(n){case s:return a;default:return e}},segments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=Object(C.a)(t,["type"]);switch(n){case g:return[a].concat(Object(S.a)(e));case y:return e.filter((function(e){return e.id!==a.id}));case N:return[].concat(Object(S.a)(a.segments),Object(S.a)(e));default:return e}}}),D);T.subscribe((function(){var e=T.getState();localStorage.setItem(O.localStorage,JSON.stringify(e))}));var _=function(e){var t,n=e.conversion,a=void 0===n?1:n,r=e.onChange,l=void 0===r?function(e){return e}:r;return c.a.createElement("select",{ref:function(e){return t=e},onChange:function(){return l(t.value)},className:"w3-select conversion-selector",defaultValue:a},O.unitConversion.map((function(e,t){var n=e.name,a=e.conversion;return c.a.createElement("option",{value:a,key:t},n)})))},A=n(25),x=function(){return{type:h}},I=function(e){var t,n=e.id,r=e.code,l=e.tmu,o=e.note,u=e.conversion,s=void 0===u?1:u,m=Object(a.useState)(!1),d=Object(i.a)(m,2),p=d[0],E=d[1],h=function(){return E(!p)};return c.a.createElement("div",{className:"w3-row-padding w3-display-container step"},c.a.createElement("div",{onClick:function(){return T.dispatch(function(e){return{type:f,id:e}}(n))},className:"w3-display-topright close"},"\xd7"),c.a.createElement("strong",{className:"w3-col l2 m2 s2"},r),p?c.a.createElement("span",{className:"w3-col l8 m8 s8"},c.a.createElement("input",{ref:function(e){return t=e},type:"text",defaultValue:o}),c.a.createElement("input",{onClick:function(){T.dispatch(function(e,t){return{type:v,id:e,note:t}}(n,t.value)),E(!1)},type:"button",value:"Speichern"}),c.a.createElement("input",{onClick:h,type:"button",value:"Abbrechen"})):c.a.createElement("span",{onClick:h,className:"w3-col l8 m8 s8 pointer"},o,"\xa0"),c.a.createElement("span",{className:"w3-col l1 m1 s1"},(parseFloat(l)*s).toFixed(5)))},L=function(){var e=T.getState().schedule,t=e.steps,n=void 0===t?[]:t,a=e.name,r=void 0===a?"":a,l=e.conversion,i=void 0===l?"":l,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return O.unitConversion.filter((function(t){return t.conversion===parseFloat(e)}))[0].name}(i),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"data:".concat(t).concat(n?";base64":"",",").concat(e)}(function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return n.join(";")+"\r\n"+e.join("\r\n")}(n.map((function(e){var t=e.code,n=e.note,a=e.tmu;return{code:t,note:n,effort:parseInt(a)*i,unit:o}})).map((function(e){return function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var c=n.length?n:Object.keys(e);return c.map((function(t){return e[t]})).join(";")}(e)})),"Code","Beschreibung","Aufwand","Einheit"),"text/csv;charset=utf-8");return c.a.createElement("div",{className:"export pointer button w3-col l2 m2 s2"},c.a.createElement("a",{download:r+".csv",target:"_blank",href:encodeURI(u)},"Export"))},U=function(){var e=T.getState().schedule,t=e.conversion,n=void 0===t?1:t,a=e.steps,r=void 0===a?[]:a,l=function(){var e=T.getState(),t=e.currentScheduleId,n=e.schedules.filter((function(e){return e.id===t}))[0];return n?n.name:""}();return l?c.a.createElement("div",{className:"w3-display-container w3-row-padding schedule"},c.a.createElement("h2",{className:"w3-col l8 m8 s8"},l),c.a.createElement("div",{className:"conversion-selector pointer w3-col l2 m2 s2"},c.a.createElement(_,{onChange:function(e){return T.dispatch(function(e){return{type:b,value:e}}(e))},conversion:n})),c.a.createElement(L,null),c.a.createElement("div",{className:"steps"},r.map((function(e,t){return c.a.createElement(I,Object.assign({},e,{conversion:n,key:t}))}))),c.a.createElement("div",{className:"footer"},c.a.createElement("div",{onClick:function(){return T.dispatch({type:E})},className:"add-step button"},"Schritt hinzuf\xfcgen +"),c.a.createElement("div",{className:"sum"},"Gesamtaufwand: ",(r.map((function(e){return e.tmu})).reduce((function(e,t){return e+parseInt(t)}),0)*n).toFixed(5)))):c.a.createElement("div",{className:"schedule w3-display-container"},c.a.createElement("p",{className:"w3-display-middle"},"Zurzeit ist kein Arbeitsplan ausgew\xe4hlt."))},P=n(13),M=function(e){var t=e.path.split("/"),n=Object(P.a)(t),a=n[0],c=n.slice(1);return Object(j.a)({},e,{name:a,path:c.join("/")})},B=function(e){var t=e.reduce((function(e,t){var n=t.name,a=void 0===n?"default":n,c=Object(C.a)(t,["name"]),r=e[a]?e[a]:[];return e[a]=[].concat(Object(S.a)(r),[c]),e}),{});return Object.keys(t).map((function(e){return{name:e,data:t[e]}}))},H=function e(t){var n=t.name,r=t.data,l=void 0===r?[]:r,o=t.onSelect,u=void 0===o?function(e){return e}:o,s=Object(a.useState)(!1),m=Object(i.a)(s,2),d=m[0],p=m[1],v=B(l.map(M)),f=T.getState().selector.currentNode,E=(void 0===f?"":f)===n;return c.a.createElement("div",{className:"tree-node ".concat(E?"selected":""),onClick:function(e){e.stopPropagation(),p(!d),T.dispatch(function(e){return{type:w,name:e}}(n)),u(l)}},c.a.createElement("h3",null,n),c.a.createElement("div",{className:"children"},d?v.map((function(t,n){return c.a.createElement(e,Object.assign({key:n},t,{onSelect:u}))})):null))},z=function(e){var t=e.selectData,n=void 0===t?function(e){return e}:t,a=T.getState().segments,r=void 0===a?[]:a;return c.a.createElement("div",{className:"tree"},B(r.map(M)).map((function(e,t){return c.a.createElement(H,Object.assign({onSelect:n,key:t},e))})))},F=function(e){var t=e.selectedData,n=void 0===t?[]:t,a=e.selectStep,r=void 0===a?function(e){return e}:a;return c.a.createElement("div",{className:"data"},c.a.createElement("table",{className:"w3-table"},n.length>0?c.a.createElement("tr",{className:"w3-hover-white"},c.a.createElement("th",null,"Details"),c.a.createElement("th",null,"Code"),c.a.createElement("th",null,"TMU")):null,n.map((function(e,t){var n=e.path,a=e.code,l=e.tmu;return c.a.createElement("tr",{key:t,onClick:function(){return r({code:a,tmu:l})}},c.a.createElement("td",null,n),c.a.createElement("td",null,a),c.a.createElement("td",null,l))}))))},G=function(e){var t,n=e.code,a=e.tmu,r=e.onSelect;if(!n||!a)return null;var l=function(){r(),T.dispatch(x())},i=function(){T.dispatch(function(e,t,n){return{type:p,id:Object(A.a)(),code:e,tmu:t,note:n}}(n,a,t.value)),r()};return c.a.createElement("div",{className:"w3-modal step-selector-confirm",style:{display:"block"}},c.a.createElement("div",{className:"w3-modal-content"},c.a.createElement("div",{className:"w3-row-padding"},c.a.createElement("h3",null,"Code: ",n," | TMU: ",a)),c.a.createElement("div",{className:"w3-row-padding"},c.a.createElement("input",{ref:function(e){return t=e},autoFocus:!0,placeholder:"Beschreibung hinzuf\xfcgen",type:"text",className:"w3-input"})),c.a.createElement("div",{className:"w3-row"},c.a.createElement("button",{onClick:function(){i(),l()},className:"w3-button w3-col l3 m3 m3"},"Hinzuf\xfcgen"),c.a.createElement("button",{onClick:i,className:"w3-button w3-col l6 m6 m6"},"Hinzuf\xfcgen und zur\xfcck zur Auswahl"),c.a.createElement("button",{onClick:l,className:"w3-button w3-col l3 m3 m3"},"Abbrechen"))))},J=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],l=Object(a.useState)({}),o=Object(i.a)(l,2),u=o[0],s=o[1],m=T.getState().selector.visible;return void 0!==m&&m?c.a.createElement("div",{className:"w3-modal w3-row",style:{display:"block"}},c.a.createElement("div",{className:"w3-modal-content w3-display-container step-selector"},c.a.createElement("h3",{className:"w3-display-topmiddle"},"Bausteine w\xe4hlen"),c.a.createElement("div",{onClick:function(){return T.dispatch(x())},className:"close w3-display-topright w3-padding-small"},"\xd7"),c.a.createElement(z,{selectData:r}),c.a.createElement(F,{selectedData:n,selectStep:s}),c.a.createElement(G,Object.assign({},u,{onSelect:function(){return s({})}})))):null},R=function(e){var t=T.getState(),n=t.schedule,a=void 0===n?{}:n,c=t.schedules,r=void 0===c?[]:c,l=t.currentScheduleId,i=JSON.stringify(a),o=r.filter((function(t){return t.id===e}))[0];if(o){var u=o.data,d=o.name,p=u?JSON.parse(u):u;T.dispatch(function(e,t){return{type:m,id:e,data:t}}(l,i)),T.dispatch(function(e,t,n){return Object(j.a)({type:s,id:e,name:t},n)}(e,d,p))}},V=function(e){var t,n=e.id,r=e.name,l=Object(a.useState)(!r),o=Object(i.a)(l,2),u=o[0],s=o[1],p=n===T.getState().currentScheduleId,v=function(){return T.dispatch(function(e,t){return{type:d,id:e,isCurrent:t}}(n,p))};return u?c.a.createElement("div",{className:"list-item"},c.a.createElement("input",{autoFocus:!0,placeholder:"Namen eingeben",ref:function(e){return t=e},type:"text",onChange:function(){return T.dispatch(function(e,t){return{type:m,id:e,name:t}}(n,t.value))},onBlur:function(){return s(!1)},defaultValue:r})):c.a.createElement("div",{onClick:function(){return R(n)},className:"list-item w3-display-container"},c.a.createElement("span",{className:"name"},r),c.a.createElement("div",{className:"w3-display-right"},c.a.createElement("span",{onClick:function(e){e.stopPropagation(),s(!0)},className:"edit icon"},"\xa0"),c.a.createElement("span",{onClick:function(e){e.stopPropagation(),v()},className:"delete icon"},"\xa0")))},W=function(e){var t=e.className,n=void 0===t?"":t,a=T.getState().schedules,r=void 0===a?[]:a;return c.a.createElement("div",{className:"schedule-list "+n},c.a.createElement("div",{onClick:function(){return T.dispatch({type:u,name:"",id:Object(A.a)(),data:""})},className:"add-schedule list-item"},"Arbeitsplan erstellen +"),c.a.createElement("hr",null),r.map((function(e,t){return c.a.createElement(V,Object.assign({},e,{key:t}))})))},K=function(){var e,t,n;return c.a.createElement("form",{className:"segment-form w3-row"},c.a.createElement("h3",null,"Manuelle Eingabe"),c.a.createElement("input",{ref:function(t){return e=t},placeholder:"Pfad",type:"text",className:"w3-input w3-mobile w3-col l3 m3 s3"}),c.a.createElement("input",{ref:function(e){return t=e},placeholder:"Code",type:"text",className:"w3-input w3-mobile w3-col l3 m3 s3"}),c.a.createElement("input",{ref:function(e){return n=e},placeholder:"TMU",type:"text",className:"w3-input w3-mobile w3-col l3 m3 s3"}),c.a.createElement("input",{type:"submit",onClick:function(a){var c,r,l;a.preventDefault(),T.dispatch((c=e.value,r=t.value,l=n.value,{id:Object(A.a)(),type:g,path:c,code:r,tmu:l})),e.value=t.value=n.value=""},value:"Speichern",className:"w3-button w3-mobile w3-input w3-col l2 m2 s2"}))},Z=function(){var e=T.getState().segments,t=void 0===e?[]:e;return t.length?c.a.createElement("table",{className:"segment-table w3-table w3-all w3-white"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Pfad"),c.a.createElement("th",null,"Code"),c.a.createElement("th",null,"TMU"))),c.a.createElement("tbody",null,t.map((function(e,t){var n=e.id,a=e.path,r=e.code,l=e.tmu;return c.a.createElement("tr",{key:t},c.a.createElement("td",null,a),c.a.createElement("td",null,r),c.a.createElement("td",null,l),c.a.createElement("td",null,c.a.createElement("div",{onClick:function(){return T.dispatch(function(e){return{type:y,id:e}}(n))},className:"close"},"\xd7")))})))):null},$=function(e){var t=e.split("\n").map((function(e){var t=e.split(";"),n=Object(i.a)(t,3);return{path:n[0],code:n[1],tmu:n[2]}}));T.dispatch(function(e){return{type:N,segments:e.map((function(e){return Object(j.a)({},e,{id:Object(A.a)()})}))}}(t))},q=function(){var e;return c.a.createElement("div",{className:"w3-row w3-white"},c.a.createElement("h3",null,"Bausteine importieren"),c.a.createElement("input",{onChange:function(){return function(e,t){var n=new FileReader;n.onload=function(){t(n.result)},n.readAsText(e.files[0])}(e,$)},ref:function(t){return e=t},type:"file",className:"w3-input"}))},Q=function(e){var t=e.show,n=void 0!==t&&t,a=e.close,r=void 0===a?function(e){return e}:a;return n?c.a.createElement("div",{className:"w3-modal",style:{display:"block"}},c.a.createElement("div",{className:"segment-manager w3-modal-content"},c.a.createElement("h2",{className:"w3-display-topmiddle w3-mobile"},"Bausteine verwalten"),c.a.createElement("div",{onClick:function(){return r(!1)},className:"close w3-display-topright w3-xlarge"},"\xd7"),c.a.createElement(K,null),c.a.createElement(q,null),c.a.createElement(Z,null))):null};n(21),n(22);var X=function(){var e=function(){var e=Object(a.useState)(0),t=Object(i.a)(e,2),n=(t[0],t[1]);return function(){return n((function(e){return++e}))}}();T.subscribe(e);var t=Object(a.useState)(!1),n=Object(i.a)(t,2),r=n[0],l=n[1],o=Object(a.useState)(!1),u=Object(i.a)(o,2),s=u[0],m=u[1];return c.a.createElement("div",{className:"App w3-row w3-display-container"},c.a.createElement("div",{className:"top-bar w3-display-top"},c.a.createElement("h1",null,"TMU-Planer"),c.a.createElement("div",{onClick:function(){return l(!r)},className:"burger-menu w3-display-topleft"},"\xa0"),c.a.createElement("div",{onClick:function(){return m(!0)},className:"settings-gear w3-display-topright"},"\xa0")),c.a.createElement(W,{className:"w3-col l3 m3 ".concat(r?"":" hidden")}),c.a.createElement("div",{className:"w3-col l9 m9 s12"},c.a.createElement(U,null)),c.a.createElement(J,null),c.a.createElement(Q,{show:s,close:m}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.8fc626ea.chunk.js.map